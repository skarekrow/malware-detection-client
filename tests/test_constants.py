import os
import string
import random


def get_random_string():
    # Used for making randomized test file names (so they don't accidentally clash with real files on the system)
    return ''.join(random.choice(string.ascii_lowercase) for _ in range(5))


CONF_FILE = "/tmp/test_malware_detection_client_%s.conf" % get_random_string()
TEST_PREFIX = '.' if os.getcwd().endswith('tests') else 'tests'
TEST_RULE1 = "%s/test_rule1.yar" % TEST_PREFIX
TEST_RULE2 = "%s/test_rule2.yar" % TEST_PREFIX
TEST_RULES_COMPILED = "%s/test_rules_compiled.yar" % TEST_PREFIX
TEST_CLIENT = "%s/test_malware_detection_client.py" % TEST_PREFIX
TEST_PARSE = "%s/test_parse_scan_output.py" % TEST_PREFIX
TEST_NETWORK = "%s/test_network_functions.py" % TEST_PREFIX
TEST_RESULTS_URL = 'http://127.0.0.1/graphql'
TEST_KEYCLOAK_URL = 'http://127.0.0.1/token'
LOCATION_PARAMS = {'rules_location': TEST_RULES_COMPILED, 'results_url': TEST_RESULTS_URL}


def remove_conf_file(conf_file=CONF_FILE):
    if os.path.exists(conf_file):
        os.remove(conf_file)
