import os
import string
import random
try:
    from urllib import quote as urlencode
except ImportError:
    from urllib.parse import quote as urlencode


def get_random_string():
    # Used for making randomized test file names (so they don't accidentally clash with real files on the system)
    return ''.join(random.choice(string.ascii_lowercase) for _ in range(5))


CONF_FILE = "/tmp/test_malware_detection_client_%s.conf" % get_random_string()
# Tests may be run in either the tests directory or its parent, so need to adjust test filenames accordingly
TEST_DIR = '.' if os.getcwd().endswith('tests') else 'tests'
TEST_CLIENT = "%s/test_malware_detection_client.py" % TEST_DIR
TEST_PARSE = "%s/test_parse_scan_output.py" % TEST_DIR
TEST_NETWORK = "%s/test_network_functions.py" % TEST_DIR
RULE1 = "%s/rule1.yar" % TEST_DIR
RULE2 = "%s/rule2.yar" % TEST_DIR
RULES_COMPILED = "%s/rules_compiled.yar" % TEST_DIR
RULE_RULE = "%s/rule rule.yar" % TEST_DIR
RULE_METADATA_TEST = "%s/rule_metadata_test.yar" % TEST_DIR
RULE_TEST_RHIMD = "%s/TEST_RedHatInsightsMalwareDetection.yar" % TEST_DIR
MATCHING_ENTITY_FILE = "%s/matching_entity" % TEST_DIR
ANOTHER_MATCHING_ENTITY_FILE = "%s/another matching_entity" % TEST_DIR
RESULTS_URL = 'http://127.0.0.1/graphql'
KEYCLOAK_URL = 'http://127.0.0.1/token'
TEST_RULE_URL = 'http://127.0.0.1/test-rule.yar'
LOCATION_PARAMS = {'rules_location': RULES_COMPILED, 'results_url': RESULTS_URL}
TEST_INSIGHTS_ID = '11111111-1111-1111-1111-111111111111'


def remove_conf_file(conf_file=CONF_FILE):
    if os.path.exists(conf_file):
        os.remove(conf_file)
