**Note**, this malware detection client has only been tested on RHEL7 and RHEL8 systems and is intended to be only run on these systems.

The Yara malware tool needs to be installed on the system.  Download and install the yara binary from [here](https://yara.readthedocs.io/en/stable/gettingstarted.html).

The malware detection client configuration is in `client.conf`.  A location for the results location will need to be configured before running the client.

Yara rules will also be need to available on the system.  The [rules] location option in the configuration file is used to specify their location.

Edit `filesystem_include.txt` as necessary to specify which filesystem objects (files/directories) to scan.

Then run the client, preferably via sudo (or as root) for a complete scan:

    $ sudo ./malware_detection_client.py

It also takes a number of optional command line arguments.  Use the `-h` option for help:

    $ ./malware_detection_client.py [-h] [-d] [-r RULES_LOCATION] [-s FILE|DIR|PID]

To scan a particular directory or PID using a particular rules file, run:

    $ sudo ./malware_detection_client.py -r <rules_file> -s <scan_dir|PID>

To setup a Python 2.7 development environment, run (note that Python 2.7 must already be on the development system):

    $ make venv27
    $ . venv27/bin/activate

To perform the tests, run:

    $ tox

... which runs the tests against both python versions 2.7 (RHEL7) and 3.6 (RHEL8).  Or:

    $ make test

... which runs the tests against the venv27 python.  There is also a `make venv36` command for setting up a python 3.6 environment (Python 3.6 must already be on the development system).
