**Note**, this malware detection client has only been tested on RHEL7 and RHEL8 systems and is intended to be only run on these systems.

The Yara malware tool needs to be installed on the system.  Download and install the yara binary from [here](https://yara.readthedocs.io/en/stable/gettingstarted.html).

The malware detection client configuration is in `client.conf`.  A location for the results location will need to be configured before running the client.

Yara rules will also be need to available on the system.  The [rules] location option in the configuration file is used to specify their location.

Edit `filesystem_include.txt` as necessary to specify which filesystem objects (files/directories) to scan.

Then run the client, preferably via sudo (or as root) for a complete scan:

    $ sudo python malware_detection_client.py

It also takes a number of optional command line arguments.  Use the `-h` option for help:

    $ python malware_detection_client.py [-h] [-d] [-r RULES_LOCATION] [-s FILE|DIR|PID]

To setup a development environment, run:

    $ pipenv install --dev
    $ pipenv shell

To perform the tests, run:

    $ tox

... which runs the tests against both python versions 2.7 (RHEL7) and 3.6 (RHEL8).  Or:

    $ make test

... which runs the tests against the pipenv python.

